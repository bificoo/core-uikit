'use strict';

var withLocale = require('../../../../_virtual/withLocale.js_commonjs-module');
require('../../../@babel/runtime/helpers/interopRequireWildcard.js');
require('../../../@babel/runtime/helpers/interopRequireDefault.js');
require('../../../@babel/runtime/helpers/extends.js');
var get = require('../../../lodash/get.js');
var React = require('react');
require('../utils/index.js');
var index = require('../../../date-fns/format/index.js');
require('./locales/default.js');
require('../utils/extendReactStatics.js');
require('./IntlProvider.js');
var _extends = require('../../../../_virtual/extends.js_commonjs-module');
var _default = require('../../../../_virtual/default.js_commonjs-module');
var extendReactStatics = require('../../../../_virtual/extendReactStatics.js_commonjs-module');
var interopRequireWildcard = require('../../../../_virtual/interopRequireWildcard.js_commonjs-module');
var index$1 = require('../../../../_virtual/index.js_commonjs-exports');
var IntlProvider = require('../../../../_virtual/IntlProvider.js_commonjs-exports');
var interopRequireDefault = require('../../../../_virtual/interopRequireDefault.js_commonjs-module');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);

(function (module, exports) {

var _interopRequireWildcard = interopRequireWildcard.interopRequireWildcard.exports;

var _interopRequireDefault = interopRequireDefault.interopRequireDefault.exports;

exports.__esModule = true;
exports.default = void 0;

var _extends2 = _interopRequireDefault(_extends._extends.exports);

var _get2 = _interopRequireDefault(get['default']);

var React = _interopRequireWildcard(React__default['default']);

var _utils = index$1.__exports;

var _format = _interopRequireDefault(index['default']);

var _default2 = _interopRequireDefault(_default._default.exports);

var _extendReactStatics = _interopRequireDefault(extendReactStatics.extendReactStatics.exports);

var _IntlProvider = IntlProvider.__exports;

var mergeObject = function mergeObject(list) {
  return list.reduce(function (a, b) {
    a = (0, _extends2.default)({}, a, {}, b);
    return a;
  }, {});
};

function withLocale(combineKeys) {
  if (combineKeys === void 0) {
    combineKeys = [];
  }

  return function (BaseComponent) {
    var WithLocale = React.forwardRef(function (props, ref) {
      return React.createElement(_IntlProvider.IntlGlobalContext.Consumer, null, function (options) {
        var locale = mergeObject(combineKeys.map(function (key) {
          return (0, _get2.default)(options || _default2.default, "" + key);
        }));

        if (options && typeof options.rtl !== undefined) {
          locale.rtl = options.rtl;
        } else if (typeof window !== 'undefined' && (document.body.getAttribute('dir') || document.dir) === 'rtl') {
          locale.rtl = true;
        }

        locale.formatDate = (options === null || options === void 0 ? void 0 : options.formatDate) || _format.default;
        return React.createElement(BaseComponent, (0, _extends2.default)({
          ref: ref,
          locale: locale
        }, props));
      });
    });
    WithLocale.displayName = BaseComponent.displayName;
    (0, _extendReactStatics.default)(WithLocale, BaseComponent, ['defaultProps']);

    if (process.env.RUN_ENV === 'test') {
      return (0, _utils.setDisplayName)((0, _utils.wrapDisplayName)(BaseComponent, '__test__'))(WithLocale);
    }

    return (0, _utils.setDisplayName)((0, _utils.wrapDisplayName)(BaseComponent, 'withLocale'))(WithLocale);
  };
}

var _default$1 = withLocale;
exports.default = _default$1;
module.exports = exports.default;
}(withLocale.withLocale, withLocale.withLocale.exports));
